

foldp : {n} (fin n) => [64] -> [n][64] -> [64]
foldp seed xs = res ! 0
  where res = [seed] # [ a + x | a <- res
                               | x <- xs
                       ]

f0 = foldp (0 : [64]) [0 .. 10] == 0x0000000000000037
f1 = foldp (0 : [64]) [0 .. 100] == 0x00000000000013ba
f2 = foldp (0 : [64]) [0 .. 1000] == 0x000000000007a314
f3 = foldp (0 : [64]) [0 .. 10000] == 0x0000000002fb0408
f4 = foldp (0 : [64]) [0 .. 100000] == 0x000000012a06b550